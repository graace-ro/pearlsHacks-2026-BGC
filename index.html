<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">  
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">  
    <title>Bake it with Churro</title>
    <link rel="icon" type="image/x-icon" href="images/Churro.svg" sizes="32x32"/>
</head>
<body>
    <div class="container">
        <h1 class ="game-title">
            <img src="images/Churro.svg" alt="Churro" class="title-icon">
            Bake it with Churro
        </h1>
        <div class = "status-header">
            <div id="rent">
                <p id="rent-value">üè† Rent: </p>
            </div>
            <div id="money">
                <p id="money-value">üí∞ Money: </p>
            </div>
            <div id="bake-option">
                <p id = "bake-option-value">üßÅ Baked Good: </p>
            </div>
        </div>
        <div class="gameplay">
            <div class="instructions" id = "instructions"> 
                <p id = "starting-text">Congratulations! You'll be starting your own bakery. Your goal is to bake and sell as many delicious treats as possible. 
                To do this you'll need to manage your ingredients, your money, and sell your baked goods to customers. Your goal is to make $5,000 in profit. Good luck, and have fun baking!</p>
            
                <p id = "your-choice-text" style="display: none;"> You get to choose where to open your bakery as well as what type of baked goods to make!</p>
            
                <p id ="baking-text" style = "display: none;">You have three different options to choose from when baking: Bread, Chocolate Cookies, and Tiramisu!</p>
                <button type="button" class="proceed" id = "proceed" onclick="nextInstruction()">Next</button>
            </div>
            <div class="YouWin">Congratulations! You've completed the game!</div>

            <div class= "YouLose">Game Over!</div>

            <div class="person"></div>

            <div class="location-choice" id = "location-choice">
                <h2>Where would you like to open your bakery?</h2>
                <button type="button" class="location-option" id="location3" onclick="smallTown()">Small Town</button>
                <button type="button" class="location-option" id="location2" onclick="suburbs()">Suburbs</button>
                <button type="button" class="location-option" id="location1" onclick="downtown()">Downtown</button>
            </div>
            <div class="baked-goods-choice" id = "baked-goods-choice">
                <h2>What type of baked goods would you like to make?</h2>
                <button type="button" class="baked-good-option" id="bakedGood1" onclick="bread()">Bread</button>
                <button type="button" class="baked-good-option" id="bakedGood2" onclick="cookies()">Chocolate Chip Cookies</button>
                <button type="button" class="baked-good-option" id="bakedGood3" onclick="tiramisu()">Tiramisu</button>
            </div>
            <div class = "display-case" id="display-case">
                <div class = "sweet-display"></div>
                <div class = "sweet-display"></div>
                <div class = "sweet-display"></div>
                <div class = "sweet-display"></div>
                <div class = "sweet-display"></div>
                <div class = "sweet-display"></div>
            </div>
            <div class="tips" id ="tips"></div>
            <div class = "display-case" id="display-case"></div>
            <div class="tips" id ="tips1F">Spend less than you earn and prepare for emergency costs! - Fidelity</div>
            <div class="tips" id ="tips1C">When you have a financial goal in mind, it's important to consider the timeline needed to achieve it - Fidelity.</div>
            <div class="tips" id="tips2F">Estimate your actual expenses- Fidelity</div>
            <div class="tips" id="tips2C">Maintain full control over your company- Capital One</div>

            <div class="randomEvents" id="SethTrimble">Seth Trimble visits your bakery! Profit skyrockets.</div>
            <div class="randomEvents" id="UNC">UNC Beats Duke increasing local festival foot traffic!</div>
            <div class="randomEvents" id="Gordon">Gordon Ramsey gives you a great review!</div>
            <div class="randomEvents" id="Equipment">Equipment breaks down, you spend money on repairs.</div>
            <div class="randomEvents" id="Flour">Flour shipment is delayed, you lose money.</div>
        </div>
        <div class = "status-header">
            <button class="month-button" id="month-button" onclick="gameplayProceed()">Start Month</button>
        </div>
            
    </div>

    <script>
        let instruction_count = 1;
        let rent = 0;
        let money = 1000;
        let month = 1;
        let selectedGood=null;
        var good;
        const goods_dialogue = document.getElementById("baked-goods-choice");
        const location_dialogue = document.getElementById("location-choice");
        const display_case = document.getElementById("display-case");
        const money_display = document.getElementById('money-value');
        money_display.innerHTML+="$" + money;
        const bake_display = document.getElementById("bake-option-value");
        const rent_display = document.getElementById("rent-value");
        const sweet_displays = document.querySelectorAll(".sweet-display");

        function gameplayProceed(){
            if (!good){
                alert("Please select a type of baked good to make!");
                return;
            }

            money -= rent;

            good.itemsBaked();

            if (month > 1 && month % 3 ===0) {
                triggerRandomEvent();
            }
            money_display.innerHTML = "üí∞ Money: $" + money;
            
            if (month % 3 === 0) {
                maybeShowTip();
            }

            bake_display.innerHTML = "üßÅ Baked Good: " ;

            month++;
            good=null;  
            goods_dialogue.style.display='block';
            goods_dialogue.style.zIndex=999;
            goods_dialogue.style.position='fixed';

            if(money>=10000){
                document.querySelector(".YouWin").style.display = 'block';
            }
            if (money<=0){
                document.querySelector(".YouLose").style.display = 'block'; 
            }
    }
        function bread(){
            let breadPop = [90, 110, 130];
            good =  new bakedGood(breadPop, 1.50, 5.50, "bread");
            bake_display.innerHTML += "Bread";
            goods_dialogue.style.display='none';
            display_case.style.display='grid';
            sweet_displays.forEach(element => {
                element.classList.add('bread-display');
            });
        }

        function cookies(){
            let cookiePop = [70, 90, 110];
            good = new bakedGood(cookiePop, 3, 9, "chocolate chip cookies");
            bake_display.innerHTML += "Chocolate Chip Cookies";
            goods_dialogue.style.display='none';
            display_case.style.display='grid';
            sweet_displays.forEach(element => {
                element.classList.add('cookies-display');
            });
          
        }

        function tiramisu(){
            let tiraPop = [45, 60, 75];
            good = new bakedGood(tiraPop, 4, 14, "tiramisu");
            bake_display.innerHTML += "Tiramisu";
            goods_dialogue.style.display='none';
            display_case.style.display='grid';
            sweet_displays.forEach(element => {
                element.classList.add('tiramisu-display');
            });
            
        }


        function bakedGood(p, c, e, n){
            this.popularity= p;
            this.cost = c;
            this.earn = e;
            this.name = n;
            this.itemsBaked = function(){
                let i = Math.floor(Math.random() * this.popularity.length);
                let numItems = this.popularity[i];
                money -= numItems*this.cost;
                money += numItems*this.earn;
                return "You sold " + numItems + " of " + name + "! You earned: " + numItems*e + " and lost " + numItems*cost + ". Your rent also cost you " + rent;
            }
        }   

        function smallTown(){
            rent = 200;
            location_dialogue.style.display = 'none';
            rent_display.innerHTML += "$" + rent;
            goods_dialogue.style.display = 'block';
        }
        function suburbs(){
            rent = 400;

            location_dialogue.style.display = 'none';
            rent_display.innerHTML += "$" + rent;
            goods_dialogue.style.display = 'block';
        }
        function downtown(){
            rent = 600;
            location_dialogue.style.display = 'none';
            rent_display.innerHTML += "$" + rent;
            goods_dialogue.style.display = 'block';
        }

        function nextInstruction(){
            console.log(instruction_count);
            let i1 = document.getElementById("starting-text");
            let i2 = document.getElementById("your-choice-text");
            let i3 = document.getElementById("baking-text");
            const instructions = [i1, i2, i3];
            const proceed_button = document.getElementById("proceed");
            const instruction_dialogue = document.getElementById("instructions");

            if(instruction_count>=instructions.length){
                instructions.forEach(element => {
                    element.style.display = 'none';
                });
                proceed_button.style.display = 'none';
                instruction_dialogue.style.display='none';
                const location_choice = document.getElementById("location-choice");
                location_choice.style.display = 'block';
                return;
            }
            if(instruction_count>0){
                instructions[instruction_count-1].style.display='none';
            }
            instructions[instruction_count].style.display = 'block';
            instruction_count+=1;
            console.log(instruction_count);
        }

        function startMonth(){
            money -= rent;

            if(good){
                good.bakeItems();

            }

            money_display.innerHTML = "üí∞ Money: $" + money;


            showTips();

            if(money>=5000){
                document.querySelector(".YouWin").style.display = 'block';
            }
            
            if (money<=0){
                document.querySelector(".YouLose").style.display = 'block';
            } 
            month++;
        }

        function maybeShowTip() {
            if (Math.random() > 0.35) return;

            const tipIds = ["tips1F", "tips1C", "tips2F", "tips2C"];
            
            tipIds.forEach(id => {
                document.getElementById(id).style.display = "none";
            });

            const randomId = tipIds[Math.floor(Math.random() * tipIds.length)];
            const tipEl = document.getElementById(randomId);
            tipEl.style.display = "block";

            setTimeout(() => {
                tipEl.style.display = "none";
            }, 4500);
            

        }
        
        const randomEvents = [
            {description: "UNC Beats Duke increasing local festival foot traffic!", moneyChange: 200},
            {description: "Seth Trimble visits your bakery! Profit skyrockets.", moneyChange: 500},
            {description: "Equipment breaks down, you spend money on repairs.", moneyChange: -200},
            {description: "Flour shipment is delayed, you lose money.", moneyChange: -150},
            {description: "Gordon Ramsey gives you a great review!", moneyChange: 300},

        ]

        function triggerRandomEvent() {
            const eventIndex = Math.floor(Math.random() * randomEvents.length);
            const event = randomEvents[eventIndex];
            money += event.moneyChange;

            alert(`Random Event: ${event.description}\nMoney charge: $${event.moneyChange}`);
        }
    </script>
</body>
</html>
